---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r "setup", include=FALSE}
require("knitr")

opts_knit$set(root.dir = "C:/JP Docs/Data Science Certification/WD/")
```

## Loading and preprocessing the data
### Read  the CSV  file in table format and create a data frame 
### Convert the data to a  R date object
```{r readdata, echo  =  TRUE}
df <- read.csv("activity.csv", header = TRUE)
df$date <- as.Date(df$date)
```


## What is mean total number of steps taken per day?
### Create  a histogram for total number of steps taken each day
```{r histogram,  echo  =  TRUE}
totalSteps <- with(df,tapply(df$steps,df$date,FUN = sum, na.rm = TRUE))

qplot(totalSteps, geom = "histogram", binwidth = 1000, xlab = "Total Steps", ylab = "Number of Days", main = "Total Number of Steps Taken Each Day")

```

### Determine mean and median total number of steps taken per day
```{r meanmediansteps,  echo  =  TRUE}

meanSteps <- mean(totalSteps, na.rm = TRUE)
medianSteps <- median(totalSteps, na.rm = TRUE)
meanSteps
medianSteps
```
### The mean  total number of steps taken per day is 9354.23.
### The median total number of steps taken per day is 10395.


## What is the average daily activity pattern?
###Create a time series plot  of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r activitypatternplot, fig.height=4,fig.width=8, echo  =  TRUE}

avgStepsPerInt <- with(na.omit(df),tapply(steps,interval,mean))
plot(names(avgStepsPerInt), avgStepsPerInt, type = "l", xlab = "5-minute Interval", 
    ylab = "Number of Steps", main = "Average Daily Activity Pattern")


```

###Determine the 5-minute interval, on average across all the days in the dataset, that contains the maximum number of steps
```{r maxinterval,  echo  =  TRUE}
maxIndex <- which(avgStepsPerInt == max(avgStepsPerInt))
maxInterval <- df$interval[maxIndex]
maxInterval
```
###The 5-minute interval, on average across all the days in the dataset, that contains the maximum number of step is 835.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
